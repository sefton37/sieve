{% extends "base.html" %}

{% block title %}Browse Articles - Sieve{% endblock %}

{% block content %}
<h1>Articles</h1>

<p class="stats">
    <small>{{ article_count }} articles total, {{ summarized_count }} summarized</small>
</p>

<!-- Filters -->
<details open>
    <summary>Filters</summary>
    <form method="get" action="{{ url_for('index') }}">
        <div class="grid">
            <label>
                Source
                <select name="source">
                    <option value="">All Sources</option>
                    {% for s in sources %}
                    <option value="{{ s }}" {% if s == source %}selected{% endif %}>{{ s }}</option>
                    {% endfor %}
                </select>
            </label>

            <label>
                Keyword
                <select name="keyword">
                    <option value="">All Keywords</option>
                    {% for k in keywords %}
                    <option value="{{ k }}" {% if k == keyword %}selected{% endif %}>{{ k }}</option>
                    {% endfor %}
                </select>
            </label>

            <label>
                Summary
                <select name="has_summary">
                    <option value="">Any</option>
                    <option value="yes" {% if has_summary == 'yes' %}selected{% endif %}>Has Summary</option>
                    <option value="no" {% if has_summary == 'no' %}selected{% endif %}>No Summary</option>
                </select>
            </label>

            <label>
                Tier
                <select name="tier">
                    <option value="">All Tiers</option>
                    <option value="1" {% if tier == '1' %}selected{% endif %}>T1 - Critical (15-21)</option>
                    <option value="2" {% if tier == '2' %}selected{% endif %}>T2 - High (10-14)</option>
                    <option value="3" {% if tier == '3' %}selected{% endif %}>T3 - Notable (5-9)</option>
                    <option value="4" {% if tier == '4' %}selected{% endif %}>T4 - Peripheral (1-4)</option>
                    <option value="5" {% if tier == '5' %}selected{% endif %}>T5 - Skip (0)</option>
                </select>
            </label>
        </div>

        <div class="grid">
            <label>
                Topic
                <select name="topic">
                    <option value="">All Topics</option>
                    {% for t in topics_list %}
                    <option value="{{ t }}" {% if t == topic %}selected{% endif %}>{{ t }}</option>
                    {% endfor %}
                </select>
            </label>

            <label>
                Entity
                <input type="text" name="entity" value="{{ entity }}" placeholder="Search entities...">
            </label>

            <label>
                Search
                <input type="text" name="search" value="{{ search }}" placeholder="Search titles...">
            </label>

            <label>
                From Date
                <input type="date" name="date_from" value="{{ date_from }}">
            </label>

            <label>
                To Date
                <input type="date" name="date_to" value="{{ date_to }}">
            </label>

            <label>
                Sort By
                <select name="sort">
                    <option value="date_desc" {% if sort == 'date_desc' %}selected{% endif %}>Date (Newest)</option>
                    <option value="date_asc" {% if sort == 'date_asc' %}selected{% endif %}>Date (Oldest)</option>
                    <option value="score_desc" {% if sort == 'score_desc' %}selected{% endif %}>Score (Highest)</option>
                    <option value="score_asc" {% if sort == 'score_asc' %}selected{% endif %}>Score (Lowest)</option>
                </select>
            </label>
        </div>

        <button type="submit">Apply Filters</button>
    </form>
</details>

<!-- Article List -->
<div id="article-list">
    {% include "partials/article_list.html" %}
</div>
{% endblock %}
